<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponential Functions Practice</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for correct/incorrect feedback */
        .correct-answer {
            border: 2px solid #22c55e; /* green-500 */
            background-color: #f0fdf4; /* green-50 */
        }
        .incorrect-answer {
            border: 2px solid #ef4444; /* red-500 */
            background-color: #fef2f2; /* red-50 */
        }
        .correct-text {
            color: #166534; /* green-800 */
            font-weight: 600;
        }
        .incorrect-text {
            color: #991b1b; /* red-800 */
            font-weight: 600;
        }
        
        /* Table Styles */
        .data-table {
            width: 100%;
            max-width: 200px;
            margin: 0 auto;
            border-collapse: collapse;
            text-align: center;
            font-size: 1.1rem;
            background-color: white;
        }
        .data-table th {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 0.5rem;
            font-weight: 600;
            font-family: 'Times New Roman', serif;
            font-style: italic;
        }
        .data-table td {
            border: 1px solid #d1d5db;
            padding: 0.5rem;
        }

        /* Input Styles */
        .math-input {
            font-family: 'Times New Roman', serif;
            font-size: 1.2rem;
            padding: 0.25rem 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            width: 80px;
            text-align: center;
        }
        .profile-input {
            width: 100%;
            padding: 0.5rem;
            font-size: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
        }
        .problem-fieldset {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            background-color: #fff;
        }
        .problem-legend {
            font-size: 1.2rem;
            font-weight: 700;
            padding: 0 0.5rem;
            color: #1f2937;
        }
        .word-problem-text {
            font-family: 'Georgia', 'Times New Roman', serif;
            font-size: 1.05rem;
            line-height: 1.5;
            color: #374151;
        }
    </style>
    <!-- Import Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 flex items-center justify-center">

    <div class="max-w-3xl w-full">
        <!-- Header -->
        <header class="mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 text-center">Exponential Functions</h1>
            <p class="text-lg text-gray-600 text-center mt-2">From tables to equations to real-world application</p>
            <!-- Game Stats -->
            <div id="game-stats" class="text-2xl font-bold text-center mt-4 text-gray-700 flex justify-center gap-6">
                <div id="lives-counter" class="text-red-500">Lives: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <div id="score-counter" class="text-blue-600">Score: 0</div>
            </div>
        </header>

        <!-- Main Card -->
        <div class="bg-white p-6 md:p-8 rounded-lg shadow-xl">
            
            <!-- Section 1: Table & Equation -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <!-- Table -->
                <div class="flex flex-col items-center justify-center">
                    <p class="mb-2 font-medium text-gray-600">Find the equation for this table:</p>
                    <table class="data-table" id="exp-table">
                        <thead>
                            <tr><th>x</th><th>y</th></tr>
                        </thead>
                        <tbody>
                            <!-- Rows inserted dynamically -->
                        </tbody>
                    </table>
                </div>

                <!-- Equation Inputs -->
                <div class="flex flex-col justify-center space-y-6">
                    <!-- P(t) Input -->
                    <div class="flex items-center gap-2 text-xl font-serif">
                        <span>P(t) = </span>
                        <input type="number" id="input-a" class="math-input" placeholder="a">
                        <span>(</span>
                        <input type="number" id="input-b" class="math-input" placeholder="b">
                        <span>)<sup>t</sup></span>
                    </div>

                    <!-- Analysis Inputs -->
                    <div class="space-y-3 bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center justify-between">
                            <label class="font-medium text-sm text-gray-700">Growth or Decay?</label>
                            <select id="input-type" class="border border-gray-300 rounded px-2 py-1 text-sm">
                                <option value="">Select...</option>
                                <option value="Growth">Growth</option>
                                <option value="Decay">Decay</option>
                            </select>
                        </div>
                        <div class="flex items-center justify-between">
                            <label class="font-medium text-sm text-gray-700">Percent Rate (%):</label>
                            <div class="flex items-center">
                                <input type="number" id="input-rate" class="border border-gray-300 rounded px-2 py-1 w-20 text-center mr-1 text-sm" placeholder="e.g. 20">
                                <span>%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Word Problem -->
            <fieldset class="problem-fieldset">
                <legend class="problem-legend">Real World Application</legend>
                <div class="mb-4">
                    <p id="word-problem-text" class="word-problem-text mb-4"></p>
                </div>
                <div class="flex items-center gap-3">
                    <label class="font-bold text-gray-700">Answer:</label>
                    <input type="number" id="input-wp" class="profile-input max-w-[200px]" placeholder="Enter value">
                    <span id="wp-unit" class="text-gray-500 text-sm font-medium"></span>
                </div>
            </fieldset>

            <!-- Feedback & Buttons -->
            <div class="mt-8 text-center">
                <div id="feedback-area" class="h-8 mb-4 font-bold"></div>
                
                <div class="flex justify-center gap-4">
                    <button id="check-btn" class="w-full md:w-1/3 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors shadow-md">
                        Check All
                    </button>
                    <button id="next-btn" class="w-full md:w-1/3 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors shadow-md hidden">
                        Next Problem
                    </button>
                    <button id="restart-btn" class="w-full md:w-1/3 bg-red-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-red-700 transition-colors shadow-md hidden">
                        Restart Game
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- State ---
        let lives = 3;
        let score = 0;
        let isGameOver = false;
        let currentData = {};
        
        // --- DOM Elements ---
        const inputs = {
            a: document.getElementById('input-a'),
            b: document.getElementById('input-b'),
            type: document.getElementById('input-type'),
            rate: document.getElementById('input-rate'),
            wp: document.getElementById('input-wp')
        };
        const allInputs = Object.values(inputs);
        
        const tableBody = document.querySelector('#exp-table tbody');
        const wpText = document.getElementById('word-problem-text');
        const wpUnit = document.getElementById('wp-unit');
        const feedbackArea = document.getElementById('feedback-area');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');

        // --- Helper Functions ---
        function getRandomInt(min, max, exclude = []) {
            let num;
            do {
                min = Math.ceil(min);
                max = Math.floor(max);
                num = Math.floor(Math.random() * (max - min + 1)) + min;
            } while (exclude.includes(num));
            return num;
        }

        function updateStats() {
            document.getElementById('lives-counter').textContent = `Lives: ${'‚ù§Ô∏è'.repeat(lives)}${'üñ§'.repeat(3 - lives)}`;
            document.getElementById('score-counter').textContent = `Score: ${score}`;
        }

        // --- Problem Generators ---

        function generateTableProblem() {
            // y = a * b^x
            const a = getRandomInt(2, 20); // Initial value
            
            // Decide b (growth or decay)
            // Growth: 2, 3, 4, 1.5? Let's stick to integers or simple decimals for ease
            // Decay: 0.5, 0.2, 0.25, 0.1
            const isGrowth = Math.random() < 0.5;
            let b;
            let type, rate;

            if(isGrowth) {
                // Growth
                if(Math.random() < 0.6) {
                    b = getRandomInt(2, 4); // Integer growth 200%, 300%
                } else {
                    b = 1.5; // 50% growth
                }
                type = "Growth";
                rate = Math.round((b - 1) * 100);
            } else {
                // Decay
                const decays = [0.5, 0.25, 0.2, 0.1];
                b = decays[getRandomInt(0, decays.length - 1)];
                type = "Decay";
                rate = Math.round((1 - b) * 100);
            }

            // Generate Table Rows (0 to 3)
            let rows = [];
            for(let x=0; x<=3; x++) {
                let y = a * Math.pow(b, x);
                // Format y to avoid tiny float errors
                y = Math.round(y * 1000) / 1000;
                rows.push({x, y});
            }

            // Render Table
            let html = '';
            rows.forEach(r => {
                html += `<tr><td>${r.x}</td><td>${r.y}</td></tr>`;
            });
            tableBody.innerHTML = html;

            return { a, b, type, rate };
        }

        function generateWordProblem() {
            const scenarios = [
                { type: 'Car', verb: 'depreciates', isGrowth: false },
                { type: 'Population', verb: 'grows', isGrowth: true },
                { type: 'Investment', verb: 'appreciates', isGrowth: true },
                { type: 'Bacteria', verb: 'decays', isGrowth: false }
            ];
            
            const sc = scenarios[getRandomInt(0, scenarios.length - 1)];
            
            let P, r, t, text, answer, unit;

            if(sc.type === 'Car') {
                P = getRandomInt(15, 45) * 1000; // $15000 - $45000
                r = getRandomInt(5, 15) + (Math.random() < 0.5 ? 0.5 : 0); // 5% - 15.5%
                t = getRandomInt(3, 8);
                unit = "dollars";
                
                text = `A new car is purchased for <b>$${P.toLocaleString()}</b>. The value of the car <b>${sc.verb}</b> at a rate of <b>${r}%</b> per year. What will be the value of the car, <i>to the nearest cent</i>, after <b>${t} years</b>?`;
                
                // A = P(1 - r)^t
                let rateDec = r / 100;
                answer = P * Math.pow(1 - rateDec, t);
                answer = Number(answer.toFixed(2)); // Nearest cent

            } else if (sc.type === 'Population') {
                P = getRandomInt(10, 50) * 1000; // 10,000 - 50,000
                r = getRandomInt(2, 8) + (Math.random() < 0.5 ? 0.5 : 0);
                t = getRandomInt(5, 15);
                unit = "people";

                text = `A town has a population of <b>${P.toLocaleString()}</b> and <b>${sc.verb}</b> at a rate of <b>${r}%</b> every year. What will be the population after <b>${t} years</b>, <i>to the nearest whole number</i>?`;

                // A = P(1 + r)^t
                let rateDec = r / 100;
                answer = P * Math.pow(1 + rateDec, t);
                answer = Math.round(answer); // Nearest whole number

            } else if (sc.type === 'Investment') {
                P = getRandomInt(5, 50) * 100; // $500 - $5000
                r = getRandomInt(3, 9);
                t = getRandomInt(5, 20);
                unit = "dollars";

                text = `An initial investment of <b>$${P.toLocaleString()}</b> <b>${sc.verb}</b> at a rate of <b>${r}%</b> per year. What will be the value, <i>to the nearest cent</i>, after <b>${t} years</b>?`;

                let rateDec = r / 100;
                answer = P * Math.pow(1 + rateDec, t);
                answer = Number(answer.toFixed(2));

            } else { // Bacteria Decay
                P = getRandomInt(500, 2000) * 10; // 5000 - 20000
                r = getRandomInt(10, 25);
                t = getRandomInt(2, 6);
                unit = "bacteria";

                text = `A bacteria culture starts with <b>${P.toLocaleString()}</b> organisms and <b>${sc.verb}</b> at a rate of <b>${r}%</b> per hour. How many bacteria are left after <b>${t} hours</b>, <i>to the nearest whole number</i>?`;

                let rateDec = r / 100;
                answer = P * Math.pow(1 - rateDec, t);
                answer = Math.round(answer);
            }

            wpUnit.textContent = unit;
            return { text, answer };
        }

        function startNewRound() {
            if(isGameOver) return;

            // Reset Inputs
            allInputs.forEach(inp => {
                inp.value = '';
                inp.disabled = false;
                inp.classList.remove('correct-answer', 'incorrect-answer');
            });
            feedbackArea.textContent = '';
            checkBtn.classList.remove('hidden');
            nextBtn.classList.add('hidden');

            const tableProb = generateTableProblem();
            const wpProb = generateWordProblem();

            currentData = {
                table: tableProb,
                wp: wpProb
            };
            
            wpText.innerHTML = wpProb.text;
        }

        // --- Check Logic ---

        function checkInput(input, correctVal, isString = false) {
            let userVal = input.value;
            if(!isString) {
                userVal = parseFloat(userVal);
                // Tolerance for decimals
                if(Math.abs(userVal - correctVal) < 0.01) {
                    input.classList.add('correct-answer');
                    input.classList.remove('incorrect-answer');
                    return true;
                }
            } else {
                if(userVal === correctVal) {
                    input.classList.add('correct-answer');
                    input.classList.remove('incorrect-answer');
                    return true;
                }
            }
            input.classList.add('incorrect-answer');
            input.classList.remove('correct-answer');
            return false;
        }

        function checkAnswers() {
            // Check Section 1
            const aOk = checkInput(inputs.a, currentData.table.a);
            const bOk = checkInput(inputs.b, currentData.table.b);
            const typeOk = checkInput(inputs.type, currentData.table.type, true);
            const rateOk = checkInput(inputs.rate, currentData.table.rate);

            // Check Section 2
            // For word problem, allow small tolerance for rounding differences
            const wpUser = parseFloat(inputs.wp.value);
            const wpOk = Math.abs(wpUser - currentData.wp.answer) <= 0.01 || Math.abs(wpUser - currentData.wp.answer) <= 1; // 1 for rounding whole numbers
            
            // Apply styling for WP manually since check logic is custom
            if(wpOk) {
                inputs.wp.classList.add('correct-answer');
                inputs.wp.classList.remove('incorrect-answer');
            } else {
                inputs.wp.classList.add('incorrect-answer');
                inputs.wp.classList.remove('correct-answer');
            }

            if (aOk && bOk && typeOk && rateOk && wpOk) {
                score++;
                updateStats();
                feedbackArea.className = "h-8 mb-4 font-bold correct-text";
                feedbackArea.textContent = "Perfect! All answers are correct.";
                allInputs.forEach(i => i.disabled = true);
                checkBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
            } else {
                lives--;
                updateStats();
                feedbackArea.className = "h-8 mb-4 font-bold incorrect-text";
                
                if (lives <= 0) {
                    isGameOver = true;
                    feedbackArea.textContent = `Game Over! Final Score: ${score}`;
                    allInputs.forEach(i => i.disabled = true);
                    checkBtn.classList.add('hidden');
                    restartBtn.classList.remove('hidden');
                    
                    // Show answers
                    inputs.a.value = currentData.table.a;
                    inputs.b.value = currentData.table.b;
                    inputs.type.value = currentData.table.type;
                    inputs.rate.value = currentData.table.rate;
                    inputs.wp.value = currentData.wp.answer;
                } else {
                    feedbackArea.textContent = "Check your answers. Make sure to round correctly!";
                }
            }
        }

        function restartGame() {
            lives = 3;
            score = 0;
            isGameOver = false;
            updateStats();
            restartBtn.classList.add('hidden');
            startNewRound();
        }

        // Events
        checkBtn.addEventListener('click', checkAnswers);
        nextBtn.addEventListener('click', startNewRound);
        restartBtn.addEventListener('click', restartGame);

        // Init
        updateStats();
        startNewRound();

    </script>
</body>
</html>