<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Systems of Equations Practice</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for correct/incorrect feedback */
        .correct-answer {
            border: 2px solid #22c55e; /* green-500 */
            background-color: #f0fdf4; /* green-50 */
        }
        .incorrect-answer {
            border: 2px solid #ef4444; /* red-500 */
            background-color: #fef2f2; /* red-50 */
        }
        .correct-text {
            color: #166534; /* green-800 */
            font-weight: 600;
        }
        .incorrect-text {
            color: #991b1b; /* red-800 */
            font-weight: 600;
        }
        /* Style for the problem display */
        .system-display {
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.5rem; /* 24px */
            font-weight: 600;
            padding: 1rem;
            background-color: #f9fafb; /* gray-50 */
            border-radius: 0.5rem;
            border: 1px solid #d1d5db; /* gray-300 */
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #1f2937; /* gray-800 */
            line-height: 1.5;
        }
        .word-problem-text {
            font-family: 'Georgia', 'Times New Roman', serif;
            font-size: 1.05rem;
            line-height: 1.5;
            color: #374151;
            text-align: left;
        }
        /* Style for input fields */
        .profile-input {
            width: 100%;
            padding: 0.5rem;
            font-size: 1rem;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        .problem-fieldset {
            border: 1px solid #e5e7eb; /* gray-200 */
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            background-color: #fff;
        }
        .problem-legend {
            font-size: 1.25rem;
            font-weight: 700;
            padding: 0 0.5rem;
            color: #1f2937; /* gray-800 */
        }
    </style>
    <!-- Import Inter font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 flex items-center justify-center">

    <div class="max-w-4xl w-full">
        <!-- Header -->
        <header class="mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 text-center">Systems of Equations</h1>
            <p class="text-lg text-gray-600 text-center mt-2">Solve each system using the specified method</p>
            <!-- Game Stats: Lives and Score -->
            <div id="game-stats" class="text-2xl font-bold text-center mt-4 text-gray-700 flex justify-center gap-6">
                <div id="lives-counter" class="text-red-500">Lives: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <div id="score-counter" class="text-blue-600">Score: 0</div>
            </div>
        </header>

        <!-- Quiz Card -->
        <div class="bg-white p-6 md:p-8 rounded-lg shadow-xl">
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Algebraic Methods Column -->
                <div class="space-y-6">
                    <!-- Problem 1: Elimination -->
                    <fieldset class="problem-fieldset">
                        <legend class="problem-legend">1. Elimination</legend>
                        <div id="elim-display" class="system-display mb-4">
                            <!-- 2x + 3y = 10 -->
                            <!-- -2x + y = 4 -->
                        </div>
                        <div class="flex gap-4">
                            <div class="w-1/2">
                                <label class="block text-sm font-semibold text-gray-600 text-center mb-1">x =</label>
                                <input type="number" id="elim-x" class="profile-input" placeholder="?">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-sm font-semibold text-gray-600 text-center mb-1">y =</label>
                                <input type="number" id="elim-y" class="profile-input" placeholder="?">
                            </div>
                        </div>
                    </fieldset>

                    <!-- Problem 2: Substitution -->
                    <fieldset class="problem-fieldset">
                        <legend class="problem-legend">2. Substitution</legend>
                        <div id="sub-display" class="system-display mb-4">
                            <!-- y = 3x + 2 -->
                            <!-- 2x + 5y = -10 -->
                        </div>
                        <div class="flex gap-4">
                            <div class="w-1/2">
                                <label class="block text-sm font-semibold text-gray-600 text-center mb-1">x =</label>
                                <input type="number" id="sub-x" class="profile-input" placeholder="?">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-sm font-semibold text-gray-600 text-center mb-1">y =</label>
                                <input type="number" id="sub-y" class="profile-input" placeholder="?">
                            </div>
                        </div>
                    </fieldset>
                </div>

                <!-- Word Problem Column -->
                <div>
                    <!-- Problem 3: Word Problem -->
                    <fieldset class="problem-fieldset h-full flex flex-col">
                        <legend class="problem-legend">3. Word Problem</legend>
                        <div id="word-problem-display" class="p-4 bg-gray-50 rounded-md border border-gray-200 mb-4 word-problem-text flex-grow">
                            <!-- Word problem text -->
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label id="wp-label-1" class="block text-sm font-semibold text-gray-600 mb-1">Variable 1:</label>
                                <input type="number" id="wp-ans-1" class="profile-input" placeholder="Enter value">
                            </div>
                            <div>
                                <label id="wp-label-2" class="block text-sm font-semibold text-gray-600 mb-1">Variable 2:</label>
                                <input type="number" id="wp-ans-2" class="profile-input" placeholder="Enter value">
                            </div>
                        </div>
                    </fieldset>
                </div>

            </div>

            <!-- Feedback Area -->
            <div id="feedback-area" class="text-center h-6 mt-6 mb-4">
                <!-- Feedback will be injected here -->
            </div>

            <!-- Button Area -->
            <div class="mt-6">
                <button id="check-btn" class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors shadow-md">
                    Check Answer
                </button>
                <button id="next-btn" class="w-full bg-green-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors shadow-md hidden">
                    Next Question
                </button>
                <button id="restart-btn" class="w-full bg-red-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-red-700 transition-colors shadow-md hidden">
                    Restart Game
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const livesCounter = document.getElementById('lives-counter');
        const scoreCounter = document.getElementById('score-counter');
        const feedbackArea = document.getElementById('feedback-area');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');

        // Inputs
        const elimX = document.getElementById('elim-x');
        const elimY = document.getElementById('elim-y');
        const subX = document.getElementById('sub-x');
        const subY = document.getElementById('sub-y');
        const wpAns1 = document.getElementById('wp-ans-1');
        const wpAns2 = document.getElementById('wp-ans-2');
        const wpLabel1 = document.getElementById('wp-label-1');
        const wpLabel2 = document.getElementById('wp-label-2');

        const allInputs = [elimX, elimY, subX, subY, wpAns1, wpAns2];

        // Displays
        const elimDisplay = document.getElementById('elim-display');
        const subDisplay = document.getElementById('sub-display');
        const wpDisplay = document.getElementById('word-problem-display');

        // --- Game State ---
        let lives = 3;
        let score = 0;
        let isGameOver = false;
        let currentProblem = {};
        let lastWordProblemType = 0;

        // --- Helper Functions ---
        function getRandomInt(min, max, exclude = []) {
            let num;
            do {
                min = Math.ceil(min);
                max = Math.floor(max);
                num = Math.floor(Math.random() * (max - min + 1)) + min;
            } while (exclude.includes(num));
            return num;
        }

        function updateStatsDisplay() {
            livesCounter.innerHTML = `Lives: ${'‚ù§Ô∏è'.repeat(lives)}${'üñ§'.repeat(3 - lives)}`;
            scoreCounter.innerHTML = `Score: ${score}`;
        }

        function formatCoeff(n) {
            if (n === 1) return "";
            if (n === -1) return "-";
            return n;
        }

        function formatTerm(coeff, variable, isFirst) {
            if (coeff === 0) return "";
            let sign = "";
            if (!isFirst) {
                sign = coeff > 0 ? " + " : " - ";
            } else {
                sign = coeff < 0 ? "-" : "";
            }
            let absCoeff = Math.abs(coeff);
            let val = (absCoeff === 1) ? "" : absCoeff;
            return `${sign}${val}${variable}`;
        }

        // --- Problem Generators ---

        function generateElimination() {
            const x = getRandomInt(-5, 5);
            const y = getRandomInt(-5, 5);

            const A = getRandomInt(2, 9);
            const B = getRandomInt(-9, 9, [0]);
            const C = A*x + B*y;

            const D = getRandomInt(2, 9, [A]); 
            const E = getRandomInt(-9, 9, [0, B]);
            const F = D*x + E*y;

            if (A/D === B/E) return generateElimination(); 

            const eq1 = `${formatTerm(A, 'x', true)}${formatTerm(B, 'y', false)} = ${C}`;
            const eq2 = `${formatTerm(D, 'x', true)}${formatTerm(E, 'y', false)} = ${F}`;

            elimDisplay.innerHTML = `<div>${eq1}</div><div>${eq2}</div>`;
            return { x, y };
        }

        function generateSubstitution() {
            const x = getRandomInt(-5, 5);
            const y = getRandomInt(-5, 5);

            const isYIsolated = Math.random() < 0.5;
            let eq1Str, eq2Str;

            if (isYIsolated) {
                const m = getRandomInt(-4, 4, [0]);
                const b = y - (m * x);
                const bStr = b > 0 ? `+ ${b}` : (b < 0 ? `- ${Math.abs(b)}` : ``);
                eq1Str = `y = ${formatTerm(m, 'x', true)} ${bStr}`;
                
                const A = getRandomInt(2, 6);
                const B = getRandomInt(-6, 6, [0]);
                const C = A*x + B*y;
                eq2Str = `${formatTerm(A, 'x', true)}${formatTerm(B, 'y', false)} = ${C}`;
            } else {
                const m = getRandomInt(-4, 4, [0]);
                const b = x - (m * y);
                const bStr = b > 0 ? `+ ${b}` : (b < 0 ? `- ${Math.abs(b)}` : ``);
                eq1Str = `x = ${formatTerm(m, 'y', true)} ${bStr}`;

                const A = getRandomInt(-6, 6, [0]);
                const B = getRandomInt(2, 6);
                const C = A*x + B*y;
                eq2Str = `${formatTerm(A, 'x', true)}${formatTerm(B, 'y', false)} = ${C}`;
            }

            subDisplay.innerHTML = `<div>${eq1Str}</div><div>${eq2Str}</div>`;
            return { x, y };
        }

        function generateWordProblem() {
            let nextType = lastWordProblemType % 4 + 1; // Cycle 1-4
            lastWordProblemType = nextType;
            
            let text, label1, label2;
            let val1, val2; // val1 -> label1, val2 -> label2

            if (nextType === 1) {
                // Type 1: Relation/Shopping (Shirt/Pants)
                // "Cost of pants is $5 more than shirts"
                const shirtCost = getRandomInt(10, 40);
                const diff = getRandomInt(5, 15);
                const pantsCost = shirtCost + diff;
                
                const numShirts = getRandomInt(5, 12);
                const numPants = getRandomInt(5, 12);
                const total = (numShirts * shirtCost) + (numPants * pantsCost);

                text = `You bought ${numShirts} shirts and ${numPants} pairs of pants for a total of $${total}. The cost of the pants is $${diff}.00 more than the cost of the shirts. Find the price of each.`;
                label1 = "Price of one Shirt ($):";
                label2 = "Price of one Pair of Pants ($):";
                val1 = shirtCost;
                val2 = pantsCost;

            } else if (nextType === 2) {
                // Type 2: Coins (Total Count & Total Value)
                const dimes = getRandomInt(10, 30);
                const quarters = getRandomInt(10, 30);
                const totalCount = dimes + quarters;
                const totalVal = (dimes * 0.10 + quarters * 0.25).toFixed(2);

                const name = ["Lizzy", "Marcus", "Sam", "Jenny"][getRandomInt(0,3)];
                text = `${name} has ${totalCount} coins that total $${totalVal}. All coins are dimes and quarters. How many of each type does ${name} have?`;
                
                label1 = "Number of Dimes:";
                label2 = "Number of Quarters:";
                val1 = dimes;
                val2 = quarters;

            } else if (nextType === 3) {
                // Type 3: Two Scenarios (Popcorn/Drinks)
                // Order 1: Ax + By = C1
                // Order 2: Dx + Ey = C2
                const costPop = getRandomInt(4, 8) + (getRandomInt(0,1) === 1 ? 0.5 : 0); // Allow .50
                const costDrink = getRandomInt(2, 5) + (getRandomInt(0,1) === 1 ? 0.5 : 0);

                const p1 = getRandomInt(2, 4); // Popcorn count 1
                const d1 = getRandomInt(2, 4); // Drink count 1
                const total1 = (p1 * costPop + d1 * costDrink).toFixed(2);

                const p2 = getRandomInt(3, 5);
                const d2 = getRandomInt(1, 3);
                const total2 = (p2 * costPop + d2 * costDrink).toFixed(2);

                text = `Jacob spends $${total1} on ${p1} bags of popcorn and ${d1} drinks. Zachary spends $${total2} on ${p2} bags of popcorn and ${d2} drinks. Find the price of one item of each.`;
                
                label1 = "Price of Popcorn ($):";
                label2 = "Price of Drink ($):";
                val1 = costPop;
                val2 = costDrink;

            } else {
                // Type 4: Ticket Sales (Large Numbers)
                const costAdult = getRandomInt(8, 15);
                const costStudent = getRandomInt(4, 8);

                const a1 = getRandomInt(100, 400); // Attendees 1
                const s1 = getRandomInt(100, 400);
                const total1 = a1 * costAdult + s1 * costStudent;

                const a2 = getRandomInt(100, 400);
                const s2 = getRandomInt(100, 400);
                const total2 = a2 * costAdult + s2 * costStudent;

                text = `A theater sold tickets for two performances. Night 1: $${total1} from ${a1} adults and ${s1} students. Night 2: $${total2} from ${a2} adults and ${s2} students. Find the ticket prices.`;
                
                label1 = "Adult Ticket Price ($):";
                label2 = "Student Ticket Price ($):";
                val1 = costAdult;
                val2 = costStudent;
            }

            wpDisplay.textContent = text;
            wpLabel1.textContent = label1;
            wpLabel2.textContent = label2;

            return { val1: val1, val2: val2 };
        }

        // --- Game Logic ---

        function startNewRound() {
            if (isGameOver) return;

            // Reset Inputs
            allInputs.forEach(inp => {
                inp.value = '';
                inp.disabled = false;
                inp.classList.remove('correct-answer', 'incorrect-answer');
            });
            feedbackArea.textContent = '';
            checkBtn.classList.remove('hidden');
            nextBtn.classList.add('hidden');

            const elimSol = generateElimination();
            const subSol = generateSubstitution();
            const wpSol = generateWordProblem();

            currentProblem = {
                elim: elimSol,
                sub: subSol,
                wp: wpSol
            };
        }

        function checkInput(input, correctVal) {
            // Use parseFloat for money problems
            const userVal = parseFloat(input.value);
            // Check with small tolerance for floats
            if (Math.abs(userVal - correctVal) < 0.01) {
                input.classList.add('correct-answer');
                input.classList.remove('incorrect-answer');
                return true;
            } else {
                input.classList.add('incorrect-answer');
                input.classList.remove('correct-answer');
                return false;
            }
        }

        function checkAnswer() {
            const elimXOk = checkInput(elimX, currentProblem.elim.x);
            const elimYOk = checkInput(elimY, currentProblem.elim.y);
            
            const subXOk = checkInput(subX, currentProblem.sub.x);
            const subYOk = checkInput(subY, currentProblem.sub.y);

            const wp1Ok = checkInput(wpAns1, currentProblem.wp.val1);
            const wp2Ok = checkInput(wpAns2, currentProblem.wp.val2);

            const allCorrect = elimXOk && elimYOk && subXOk && subYOk && wp1Ok && wp2Ok;

            if (allCorrect) {
                score++;
                updateStatsDisplay();
                feedbackArea.innerHTML = `<p class="correct-text">Perfect! All systems solved.</p>`;
                allInputs.forEach(i => i.disabled = true);
                checkBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
            } else {
                lives--;
                updateStatsDisplay();
                if (lives <= 0) {
                    isGameOver = true;
                    feedbackArea.innerHTML = `<p class="incorrect-text text-xl font-bold">Game Over! Final Score: ${score}</p>`;
                    allInputs.forEach(i => i.disabled = true);
                    checkBtn.classList.add('hidden');
                    restartBtn.classList.remove('hidden');
                    
                    // Show Answers
                    elimX.value = currentProblem.elim.x;
                    elimY.value = currentProblem.elim.y;
                    subX.value = currentProblem.sub.x;
                    subY.value = currentProblem.sub.y;
                    wpAns1.value = currentProblem.wp.val1;
                    wpAns2.value = currentProblem.wp.val2;
                } else {
                    feedbackArea.innerHTML = `<p class="incorrect-text">Check the red boxes and try again.</p>`;
                }
            }
        }

        function restartGame() {
            lives = 3;
            score = 0;
            isGameOver = false;
            updateStatsDisplay();
            restartBtn.classList.add('hidden');
            startNewRound();
        }

        // Event Listeners
        checkBtn.addEventListener('click', checkAnswer);
        nextBtn.addEventListener('click', startNewRound);
        restartBtn.addEventListener('click', restartGame);

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            updateStatsDisplay();
            startNewRound();
        });

    </script>
</body>
</html>