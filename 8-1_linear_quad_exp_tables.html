<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Identify Function Families</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for correct/incorrect feedback */
        .correct-answer {
            border: 2px solid #22c55e; /* green-500 */
            background-color: #f0fdf4; /* green-50 */
        }
        .incorrect-answer {
            border: 2px solid #ef4444; /* red-500 */
            background-color: #fef2f2; /* red-50 */
        }
        .correct-text {
            color: #166534; /* green-800 */
            font-weight: 600;
        }
        .incorrect-text {
            color: #991b1b; /* red-800 */
            font-weight: 600;
        }
        
        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            font-size: 1.1rem;
            background-color: white;
        }
        .data-table th {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 0.5rem;
            font-weight: 600;
            width: 50%;
        }
        .data-table td {
            border: 1px solid #d1d5db;
            padding: 0.5rem;
        }

        /* Card Styles */
        .problem-card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .card-header {
            font-weight: 700;
            color: #374151;
            width: 100%;
            text-align: left;
            border-bottom: 2px solid #f3f4f6;
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem;
        }

        /* Selection Button Styles */
        .type-btn {
            width: 100%;
            padding: 0.5rem;
            margin-top: 0.25rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            color: #374151;
            font-weight: 500;
            transition: all 0.2s;
        }
        .type-btn:hover {
            background-color: #f9fafb;
            border-color: #9ca3af;
        }
        .type-btn.selected {
            background-color: #dbeafe;
            border-color: #3b82f6;
            color: #1d4ed8;
            font-weight: 600;
        }
    </style>
    <!-- Import Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 flex items-center justify-center">

    <div class="max-w-6xl w-full">
        <!-- Header -->
        <header class="mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 text-center">Identify Function Families</h1>
            <p class="text-lg text-gray-600 text-center mt-2">Determine if each table represents a Linear, Quadratic, or Exponential function.</p>
            <!-- Game Stats -->
            <div id="game-stats" class="text-2xl font-bold text-center mt-4 text-gray-700 flex justify-center gap-6">
                <div id="lives-counter" class="text-red-500">Lives: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <div id="score-counter" class="text-blue-600">Score: 0</div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="bg-white p-6 rounded-lg shadow-xl">
            
            <!-- Problems Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="problems-grid">
                <!-- Table 1 -->
                <div class="problem-card" id="card-0">
                    <div class="card-header">Table A</div>
                    <div class="w-full">
                        <table class="data-table" id="table-0">
                            <thead><tr><th>x</th><th>y</th></tr></thead>
                            <tbody><!-- Rows inserted dynamically --></tbody>
                        </table>
                    </div>
                    <div class="w-full space-y-2">
                        <p class="text-sm font-semibold text-gray-500 mb-1">Select Type:</p>
                        <button class="type-btn" onclick="selectType(0, 'Linear')">Linear</button>
                        <button class="type-btn" onclick="selectType(0, 'Quadratic')">Quadratic</button>
                        <button class="type-btn" onclick="selectType(0, 'Exponential')">Exponential</button>
                    </div>
                </div>

                <!-- Table 2 -->
                <div class="problem-card" id="card-1">
                    <div class="card-header">Table B</div>
                    <div class="w-full">
                        <table class="data-table" id="table-1">
                            <thead><tr><th>x</th><th>y</th></tr></thead>
                            <tbody><!-- Rows inserted dynamically --></tbody>
                        </table>
                    </div>
                    <div class="w-full space-y-2">
                        <p class="text-sm font-semibold text-gray-500 mb-1">Select Type:</p>
                        <button class="type-btn" onclick="selectType(1, 'Linear')">Linear</button>
                        <button class="type-btn" onclick="selectType(1, 'Quadratic')">Quadratic</button>
                        <button class="type-btn" onclick="selectType(1, 'Exponential')">Exponential</button>
                    </div>
                </div>

                <!-- Table 3 -->
                <div class="problem-card" id="card-2">
                    <div class="card-header">Table C</div>
                    <div class="w-full">
                        <table class="data-table" id="table-2">
                            <thead><tr><th>x</th><th>y</th></tr></thead>
                            <tbody><!-- Rows inserted dynamically --></tbody>
                        </table>
                    </div>
                    <div class="w-full space-y-2">
                        <p class="text-sm font-semibold text-gray-500 mb-1">Select Type:</p>
                        <button class="type-btn" onclick="selectType(2, 'Linear')">Linear</button>
                        <button class="type-btn" onclick="selectType(2, 'Quadratic')">Quadratic</button>
                        <button class="type-btn" onclick="selectType(2, 'Exponential')">Exponential</button>
                    </div>
                </div>
            </div>

            <!-- Feedback & Buttons -->
            <div class="mt-8 text-center">
                <div id="feedback-area" class="h-8 mb-4 font-bold"></div>
                
                <div class="flex justify-center gap-4">
                    <button id="check-btn" class="w-full md:w-1/3 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors shadow-md">
                        Check Answers
                    </button>
                    <button id="next-btn" class="w-full md:w-1/3 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors shadow-md hidden">
                        Next Set
                    </button>
                    <button id="restart-btn" class="w-full md:w-1/3 bg-red-600 text-white px-6 py-3 rounded-lg font-semibold text-lg hover:bg-red-700 transition-colors shadow-md hidden">
                        Restart Game
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- State ---
        let lives = 3;
        let score = 0;
        let isGameOver = false;
        let currentTypes = []; // Array of correct types for the 3 tables
        let userSelections = [null, null, null]; // User's current selection for each table

        // --- DOM ---
        const livesCounter = document.getElementById('lives-counter');
        const scoreCounter = document.getElementById('score-counter');
        const feedbackArea = document.getElementById('feedback-area');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');

        // --- Helper Functions ---
        function getRandomInt(min, max, exclude = []) {
            let num;
            do {
                min = Math.ceil(min);
                max = Math.floor(max);
                num = Math.floor(Math.random() * (max - min + 1)) + min;
            } while (exclude.includes(num));
            return num;
        }

        function updateStats() {
            livesCounter.innerHTML = `Lives: ${'‚ù§Ô∏è'.repeat(lives)}${'üñ§'.repeat(3 - lives)}`;
            scoreCounter.innerHTML = `Score: ${score}`;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- Data Generation ---

        function generateLinearTable() {
            // y = mx + b
            const m = getRandomInt(-5, 5, [0]);
            const b = getRandomInt(-10, 10);
            const startX = getRandomInt(0, 5);
            
            let rows = [];
            for(let i=0; i<5; i++) {
                let x = startX + i;
                let y = m*x + b;
                rows.push({x, y});
            }
            return { type: 'Linear', rows };
        }

        function generateQuadraticTable() {
            // y = ax^2 + bx + c
            const a = getRandomInt(-2, 2, [0]);
            const b = getRandomInt(-5, 5);
            const c = getRandomInt(-10, 10);
            // Center x around vertex roughly (-b/2a) to show curvature
            let vertexX = Math.round(-b / (2*a));
            let startX = vertexX - 2; 
            
            let rows = [];
            for(let i=0; i<5; i++) {
                let x = startX + i;
                let y = a*x*x + b*x + c;
                rows.push({x, y});
            }
            return { type: 'Quadratic', rows };
        }

        function generateExponentialTable() {
            // y = a * b^x
            // Keep numbers small so they don't explode
            const base = getRandomInt(2, 3); // Base 2 or 3
            const a = getRandomInt(1, 3) * (Math.random() < 0.5 ? 1 : -1);
            const startX = getRandomInt(0, 2);
            
            let rows = [];
            for(let i=0; i<5; i++) {
                let x = startX + i;
                let y = a * Math.pow(base, x);
                rows.push({x, y});
            }
            return { type: 'Exponential', rows };
        }

        // --- UI Logic ---

        function renderTable(tableId, rows) {
            const tbody = document.querySelector(`#${tableId} tbody`);
            let html = '';
            rows.forEach(r => {
                html += `<tr><td>${r.x}</td><td>${r.y}</td></tr>`;
            });
            tbody.innerHTML = html;
        }

        // Global function for button clicks
        window.selectType = function(cardIndex, type) {
            if(isGameOver) return; // Prevent selection if game over
            
            userSelections[cardIndex] = type;
            
            // Update UI classes
            const card = document.getElementById(`card-${cardIndex}`);
            const btns = card.querySelectorAll('.type-btn');
            btns.forEach(btn => {
                if(btn.textContent === type) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        };

        function startNewRound() {
            if(isGameOver) return;

            // Reset State
            userSelections = [null, null, null];
            feedbackArea.className = "h-8 mb-4 font-bold";
            feedbackArea.textContent = '';
            checkBtn.classList.remove('hidden');
            nextBtn.classList.add('hidden');

            // Reset UI Buttons
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.remove('selected', 'correct-answer', 'incorrect-answer');
                btn.disabled = false;
            });

            // Generate 3 distinct tables
            let funcs = [
                generateLinearTable(),
                generateQuadraticTable(),
                generateExponentialTable()
            ];
            
            // Shuffle order
            funcs = shuffleArray(funcs);
            currentTypes = funcs.map(f => f.type);

            // Render
            renderTable('table-0', funcs[0].rows);
            renderTable('table-1', funcs[1].rows);
            renderTable('table-2', funcs[2].rows);
        }

        function checkAnswers() {
            // Validate all selected
            if(userSelections.includes(null)) {
                feedbackArea.className = "h-8 mb-4 font-bold incorrect-text";
                feedbackArea.textContent = "Please select a type for every table.";
                return;
            }

            let allCorrect = true;

            // Check each card
            for(let i=0; i<3; i++) {
                const correct = currentTypes[i];
                const selected = userSelections[i];
                const card = document.getElementById(`card-${i}`);
                const btns = card.querySelectorAll('.type-btn');

                // Find selected button
                let selectedBtn;
                btns.forEach(b => {
                    if(b.textContent === selected) selectedBtn = b;
                    b.disabled = true; // Disable all buttons
                });

                if(selected === correct) {
                    selectedBtn.classList.add('correct-answer');
                    selectedBtn.classList.remove('selected'); // Remove blue selection style
                } else {
                    selectedBtn.classList.add('incorrect-answer');
                    selectedBtn.classList.remove('selected');
                    allCorrect = false;
                    
                    // Highlight the correct one
                    btns.forEach(b => {
                        if(b.textContent === correct) {
                            b.classList.add('correct-answer'); // Show correct in green
                            // Add a small "Correct Answer" indicator text if needed, or just relies on green
                        }
                    });
                }
            }

            if(allCorrect) {
                score++;
                updateStats();
                feedbackArea.className = "h-8 mb-4 font-bold correct-text";
                feedbackArea.textContent = "Perfect! You identified all three correctly.";
                checkBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
            } else {
                lives--;
                updateStats();
                feedbackArea.className = "h-8 mb-4 font-bold incorrect-text";
                
                if(lives <= 0) {
                    isGameOver = true;
                    feedbackArea.textContent = `Game Over! Final Score: ${score}`;
                    checkBtn.classList.add('hidden');
                    restartBtn.classList.remove('hidden');
                } else {
                    feedbackArea.textContent = "Not quite. Review the green answers.";
                    checkBtn.classList.add('hidden');
                    nextBtn.classList.remove('hidden'); // Let them move on after seeing answers
                    nextBtn.textContent = "Try Next Set"; 
                }
            }
        }

        function restartGame() {
            lives = 3;
            score = 0;
            isGameOver = false;
            updateStats();
            restartBtn.classList.add('hidden');
            startNewRound();
        }

        // Events
        checkBtn.addEventListener('click', checkAnswers);
        nextBtn.addEventListener('click', startNewRound);
        restartBtn.addEventListener('click', restartGame);

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            startNewRound();
        });

    </script>
</body>
</html>